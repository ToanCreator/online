<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>To√†n Creator - Online Lesson</title>
<style>
  :root {
    --yellow: #f9d342;
    --yellow-dark: #d4b833;
    --Green: #2ecc71;
    --starsGreen: #2ecc71;
    --red: #d93025;
    --green: #2ecc40;
    --starsGray: #ccc;
    --star-size: 30px;
    --orange: #ff9800;
  }
  body {
    margin:0; padding:0; font-family: Arial, sans-serif;
    background: white; color: black;
    transition: background-color 0.3s, color 0.3s;
  }
  body.dark {
    background: black; color: white;
  }
  /* Existing #app rule */
#app {
  max-width: 600px;
  margin: 0 auto;
  padding: 15px;
}

/* Media query for larger screens (e.g., tablets and desktops) */
@media (min-width: 768px) {
  #app {
    max-width: 960px; /* Or any wider value you prefer, e.g., 900px, 1200px */
    padding: 20px; /* Optional: Increase padding for more space on larger screens */
  }

  /* Optional: Adjust button widths for larger screens if they look too wide */
  .btn {
    max-width: 400px; /* Make main buttons a bit wider */
  }

  /* Optional: Adjust status bar layout for larger screens */
  .status-bar {
    font-size: 1.1em;
  }
}
  h1, h3 {
    text-align: center;
    margin: 10px 0;
  }
  h2 {
    text-align: center;
    margin: 10px 0;
    color: #FF00FF;
  }
  hr {
    border:none; border-bottom: 3px solid black;
    margin: 5px 0 25px 0;
  }
  .btn {
    background: #3399FF;
    border-radius: 8px;
    border:none;
    color: white;
    font-weight: bold;
    font-size: 1.2em;
    padding: 15px;
    width: 100%;
    max-width: 350px;
    margin: 10px auto;
    cursor: pointer;
    display: block;
    box-sizing: border-box;
    text-align: center;
    border: 3px solid transparent;
    user-select: none;
  }
  .btn:hover {
    background: var(--yellow-dark);
  }
  .btn svg {
    vertical-align: middle;
  }
  .question-container {
    margin-bottom: 20px;
    color: var(--orange) !important;
    font-weight: bold;
    font-size: 1.08em;
    transition: color 0.3s;
  }
  body.dark .question-container {
    color: var(--orange) !important;
  }
  .answers {
    margin-top: 15px;
  }
  .answer-btn {
    display: block;
    width: 100%;
    border: 2px solid black;
    border-radius: 6px;
    background-color: white;
    color: black;
    font-size: 1em;
    padding: 12px 10px;
    margin: 7px 0;
    cursor: pointer;
    text-align: left;
    user-select: none;
    transition: background-color 0.3s, border-color 0.3s, color 0.3s;
  }
  .answer-btn:hover:not(.disabled) {
    background-color: #eee;
  }
  body.dark .answer-btn {
    background-color: #222;
    color: white;
    border-color: white;
  }
  body.dark .answer-btn:hover:not(.disabled) {
    background-color: #444;
  }
  .answer-btn.correct {
    background-color: var(--green) !important;
    color: white !important;
    border-color: var(--green) !important;
  }
  .answer-btn.incorrect {
    background-color: var(--red) !important;
    color: white !important;
    border-color: var(--red) !important;
  }
  body.dark .answer-btn.correct {
    background-color: var(--green) !important;
    color: white !important;
    border-color: var(--green) !important;
  }
  body.dark .answer-btn.incorrect {
    background-color: var(--red) !important;
    color: white !important;
    border-color: var(--red) !important;
  }
  .disabled {
    pointer-events: none;
  }
  .status-bar {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    font-weight: bold;
  }
  .star-container {
    text-align: center;
    margin: 20px 0 10px 0;
  }
  .star {
    font-size: var(--star-size);
    margin: 0 5px;
    color: var(--starsGray);
  }
  .star.Green {
    color: var(--Green);
  }
  .star.red {
    color: var(--red);
  }
  .toggle-btn {
    background: lime;
    color: white;
    font-size: 1.5em;
    padding: 12px 0;
    margin: 25px auto;
    width: 150px;
    border-radius: 6px;
    cursor: pointer;
    user-select: none;
    display: block;
  }
  .input-textarea {
    width: 100%;
    min-height: 80px;
    font-size: 1em;
    padding: 10px;
    border-radius: 6px;
    border: 2px solid black;
    resize: vertical;
    box-sizing: border-box;
  }
  body.dark .input-textarea {
    background-color: #222;
    color: white;
    border-color: white;
  }
  .btn-small {
    background: #FF99CC;
    width: auto;
    padding: 8px 15px;
    font-size: 1em;
    margin-top: 10px;
  }
  .answer-btn img {
    max-width: 100%;
    max-height: 150px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 3px;
  }
  .question-container img {
    max-width: 100%;
    max-height: 300px;
    margin: 15px 0;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  body.dark .answer-btn img,
  body.dark .question-container img {
    border-color: #555;
  }
  .question-container img, .answer-btn img {
    display: block;
    margin: 0 auto;
    background: #f5f5f5;
  }
  body.dark .question-container img,
  body.dark .answer-btn img {
    background: #333;
  }
  /* Style for the header image placeholder */
  .header-image-placeholder {
    display: block;
    width: 100%; /* Ho·∫∑c m·ªôt chi·ªÅu r·ªông c·ªë ƒë·ªãnh */
    height: 100px; /* ƒêi·ªÅu ch·ªânh chi·ªÅu cao n√†y ƒë·ªÉ ph√π h·ª£p v·ªõi k√≠ch th∆∞·ªõc b·∫°n mu·ªën */
    background-color: #f0f0f0; /* M√†u n·ªÅn ƒë·ªÉ d·ªÖ nh√¨n th·∫•y placeholder */
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.5em;
    color: #666;
    margin-bottom: 25px; /* Kho·∫£ng c√°ch v·ªõi ti√™u ƒë·ªÅ b√™n d∆∞·ªõi */
    
  }
  body.dark .header-image-placeholder {
    background-color: #333;
    color: #bbb;
  }
</style>
</head>
<body>
<div id="app">
  <img src="https://i.ibb.co/tMdHNdPH/Picsart-25-07-17-06-40-25-073.jpg" alt="Header Image" class="header-image-placeholder">
  
  <h2>TIN - B√ÄI 1</h2>

  <button class="btn" id="btn-exit" style="background: var(--red);">
    <svg width="24" height="24" fill="white" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:5px;">
      <path d="M16 17v-4h-2V7h-4V4H6V2H4v2h2v4h4v6h2v4h4v2h2v-2h-2z"/>
    </svg>
    Tho√°t
  </button>
  <button class="btn" id="btn-multi">TR·∫ÆC NGHI·ªÜM 4 PH∆Ø∆†NG √ÅN</button>
  <button class="btn" id="btn-truefalse">TR·∫ÆC NGHI·ªÜM ƒê√öNG/SAI</button>
  <button class="btn" id="btn-essay">T·ª∞ LU·∫¨N</button>

  <button class="toggle-btn" id="toggle-theme">üí°</button>
  <button class="toggle-btn" id="btn-download" style="background: orange; margin-top: -20px; margin-bottom: 25px;">
    T·∫£i xu·ªëng
  </button>
  <div id="quiz-section" style="display:none; margin-top: 10px;">
    <div class="status-bar">
      <div>Th·ªùi gian:<span id="timer">00:00</span></div>
      <div>C√¢u ƒë√£ l√†m:<span id="done-count">0</span></div>
      <div>ƒê√∫ng:<span id="correct-count">0</span> | <strong>Sai:</strong><span id="wrong-count">0</span></div>
    </div>

    <div id="question-block" class="question-container"></div>
    <div id="answers-block" class="answers"></div>

    <div id="essay-input-block" style="display:none;">
      <textarea id="essay-answer" class="input-textarea" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi c·ªßa b·∫°n..."></textarea>
      <button id="btn-essay-submit" class="btn-small">Xong</button>
    </div>

    <div style="display:flex; justify-content: space-between; margin-top: 20px;">
      <button id="btn-back-home-in-quiz" class="btn btn-small" style="background: var(--Green); width: 48%;">
        <svg width="24" height="24" fill="white" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:5px;">
          <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
        </svg>
      </button>
      <button id="btn-next" class="btn btn-small" style="width: 48%;">Ti·∫øp t·ª•c</button>
    </div>
  </div>

  <div id="result-section" style="display:none; text-align:center; margin-top: 30px;">
    <h2>K·∫æT TH√öC B√ÄI L√ÄM</h2>
    <div><strong>T·ªïng th·ªùi gian l√†m b√†i:</strong> <span id="result-time"></span></div>
    <div><strong>T·ªïng s·ªë c√¢u ƒë√£ l√†m:</strong> <span id="result-total"></span></div>
    <div><strong>ƒê√∫ng:</strong><span id="result-correct"></span><strong> | </strong><strong>Sai:</strong><span id="result-wrong"></span></div>
    <div id="star-rating" class="star-container"></div>
    <div style="margin-top: 25px;">
      <button id="btn-home" class="btn" style="display:inline-block; width:120px;">
        <svg width="24" height="24" fill="white" viewBox="0 0 24 24" style="vertical-align:middle; margin-right:5px;">
          <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
        </svg> 
      </button>
      </div>
  </div>
</div>

<script>
(() => {
  // --- QUESTION DATA ---
  // Tr·∫Øc nghi·ªám 4 ph∆∞∆°ng √°n [ABCD]
  const multiChoiceQuestions = [
  {
    q: "Tr√≠ tu·ªá nh√¢n t·∫°o (AI) ƒë∆∞·ª£c nh·∫Øc ƒë·∫øn l·∫ßn ƒë·∫ßu ti√™n v√†o nƒÉm n√†o?",
    answers: [
      { text: "1950", correct: true },
      { text: "1960", correct: false },
      { text: "1970", correct: false },
      { text: "1980", correct: false }
    ]
  },
  {
    q: "AI l√† vi·∫øt t·∫Øt c·ªßa t·ª´ g√¨?",
    answers: [
      { text: "Artificial Intelligence", correct: true },
      { text: "Automated Integration", correct: false },
      { text: "Advanced Intelligence", correct: false },
      { text: "Artificial Integration", correct: false }
    ]
  },
  {
    q: "Ai l√† ng∆∞·ªùi ƒë√£ ƒë·ªÅ c·∫≠p ƒë·∫øn kh√°i ni·ªám AI ƒë·∫ßu ti√™n?",
    answers: [
      { text: "John McCarthy", correct: true },
      { text: "Alan Turing", correct: false },
      { text: "Elon Musk", correct: false },
      { text: "Bill Gates", correct: false }
    ]
  },
  {
    q: "H·ªôi th·∫£o ƒë√°nh d·∫•u s·ª± ra ƒë·ªùi c·ªßa lƒ©nh v·ª±c AI ƒë∆∞·ª£c t·ªï ch·ª©c v√†o nƒÉm n√†o?",
    answers: [
      { text: "1956", correct: true },
      { text: "1950", correct: false },
      { text: "1952", correct: false },
      { text: "1954", correct: false }
    ]
  },
  {
    q: "·ª®ng d·ª•ng n√†o sau ƒë√¢y kh√¥ng ph·∫£i l√† ·ª©ng d·ª•ng c·ªßa AI?",
    answers: [
      { text: "Gu·ªìng n∆∞·ªõc ·ªü v√πng qu√™", correct: true },
      { text: "Google Translate", correct: false },
      { text: "Robot Asimo", correct: false },
      { text: "Tr·ª£ l√Ω ·∫£o Siri", correct: false }
    ]
  },
  {
    q: "Kh·∫£ nƒÉng h·ªçc c·ªßa AI l√† g√¨?",
    answers: [
      { text: "N·∫Øm b·∫Øt th√¥ng tin t·ª´ d·ªØ li·ªáu v√† ƒëi·ªÅu ch·ªânh h√†nh vi", correct: true },
      { text: "T·ª± ƒë·ªông h√≥a m·ªçi c√¥ng vi·ªác m√† kh√¥ng c·∫ßn d·ªØ li·ªáu", correct: false },
      { text: "Thay th·∫ø con ng∆∞·ªùi ho√†n to√†n", correct: false },
      { text: "Ch·ªâ ho·∫°t ƒë·ªông d·ª±a tr√™n l·∫≠p tr√¨nh c·ª©ng", correct: false }
    ]
  },
  {
    q: "Kh·∫£ nƒÉng suy lu·∫≠n c·ªßa AI li√™n quan ƒë·∫øn ƒëi·ªÅu g√¨?",
    answers: [
      { text: "V·∫≠n d·ª•ng logic v√† tri th·ª©c ƒë·ªÉ ra quy·∫øt ƒë·ªãnh", correct: true },
      { text: "Nh·∫≠n d·∫°ng h√¨nh ·∫£nh m√† kh√¥ng c·∫ßn logic", correct: false },
      { text: "T·ª± ƒë·ªông h√≥a c√°c t√°c v·ª• v·∫≠t l√Ω", correct: false },
      { text: "H·ªçc d·ªØ li·ªáu m√† kh√¥ng c·∫ßn tri th·ª©c", correct: false }
    ]
  },
  {
    q: "Kh·∫£ nƒÉng nh·∫≠n th·ª©c c·ªßa AI bao g·ªìm vi·ªác g√¨?",
    answers: [
      { text: "C·∫£m nh·∫≠n v√† hi·ªÉu m√¥i tr∆∞·ªùng qua c·∫£m bi·∫øn v√† d·ªØ li·ªáu", correct: true },
      { text: "Ch·ªâ th·ª±c hi·ªán c√°c t√°c v·ª• ƒë∆°n gi·∫£n", correct: false },
      { text: "Ra quy·∫øt ƒë·ªãnh m√† kh√¥ng c·∫ßn d·ªØ li·ªáu", correct: false },
      { text: "T·ª± ƒë·ªông h√≥a c√¥ng vi·ªác th·ªß c√¥ng", correct: false }
    ]
  },
  {
    q: "Kh·∫£ nƒÉng hi·ªÉu ng√¥n ng·ªØ c·ªßa AI l√† g√¨?",
    answers: [
      { text: "Hi·ªÉu v√† x·ª≠ l√Ω ng√¥n ng·ªØ t·ª± nhi√™n c·ªßa con ng∆∞·ªùi", correct: true },
      { text: "Ch·ªâ hi·ªÉu ng√¥n ng·ªØ l·∫≠p tr√¨nh", correct: false },
      { text: "Kh√¥ng th·ªÉ x·ª≠ l√Ω vƒÉn b·∫£n", correct: false },
      { text: "Ch·ªâ nh·∫≠n di·ªán √¢m thanh", correct: false }
    ]
  },
  {
    q: "Kh·∫£ nƒÉng gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ c·ªßa AI li√™n quan ƒë·∫øn ƒëi·ªÅu g√¨?",
    answers: [
      { text: "T√¨m c√°ch gi·∫£i quy·∫øt t√¨nh hu·ªëng ph·ª©c t·∫°p d·ª±a tr√™n th√¥ng tin", correct: true },
      { text: "Ch·ªâ gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ ƒë∆°n gi·∫£n", correct: false },
      { text: "Kh√¥ng c·∫ßn th√¥ng tin ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ", correct: false },
      { text: "T·ª± ƒë·ªông h√≥a m√† kh√¥ng c·∫ßn suy nghƒ©", correct: false }
    ]
  },
  {
    q: "AI h·∫πp (Narrow AI) c√≥ ƒë·∫∑c ƒëi·ªÉm g√¨?",
    answers: [
      { text: "ƒê∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ th·ª±c hi·ªán m·ªôt nhi·ªám v·ª• c·ª• th·ªÉ", correct: true },
      { text: "C√≥ kh·∫£ nƒÉng th·ª±c hi·ªán m·ªçi c√¥ng vi·ªác nh∆∞ con ng∆∞·ªùi", correct: false },
      { text: "Kh√¥ng c·∫ßn d·ªØ li·ªáu ƒë·ªÉ ho·∫°t ƒë·ªông", correct: false },
      { text: "T·ª± th√≠ch nghi m√† kh√¥ng c·∫ßn l·∫≠p tr√¨nh", correct: false }
    ]
  },
  {
    q: "AI t·ªïng qu√°t (General AI) c√≥ ƒë·∫∑c ƒëi·ªÉm g√¨?",
    answers: [
      { text: "C√≥ kh·∫£ nƒÉng t·ª± h·ªçc v√† th·ª±c hi·ªán nhi·ªÅu c√¥ng vi·ªác nh∆∞ con ng∆∞·ªùi", correct: true },
      { text: "Ch·ªâ th·ª±c hi·ªán m·ªôt nhi·ªám v·ª• c·ª• th·ªÉ", correct: false },
      { text: "Kh√¥ng th·ªÉ hi·ªÉu ng√¥n ng·ªØ t·ª± nhi√™n", correct: false },
      { text: "Kh√¥ng c·∫ßn d·ªØ li·ªáu ƒë·ªÉ ho·∫°t ƒë·ªông", correct: false }
    ]
  },
  {
    q: "H·ªá chuy√™n gia MYCIN ƒë∆∞·ª£c s·ª≠ d·ª•ng trong lƒ©nh v·ª±c n√†o?",
    answers: [
      { text: "Y h·ªçc", correct: true },
      { text: "Giao th√¥ng", correct: false },
      { text: "Gi√°o d·ª•c", correct: false },
      { text: "Th·ªÉ thao", correct: false }
    ]
  },
  {
    q: "Robot Asimo l√† s·∫£n ph·∫©m c·ªßa c√¥ng ty n√†o?",
    answers: [
      { text: "Honda", correct: true },
      { text: "Tesla", correct: false },
      { text: "Google", correct: false },
      { text: "Microsoft", correct: false }
    ]
  },
  {
    q: "Google Translate ch·ªß y·∫øu ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ l√†m g√¨?",
    answers: [
      { text: "D·ªãch thu·∫≠t", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "H·ªó tr·ª£ l√°i xe", correct: false }
    ]
  },
  {
    q: "·ª®ng d·ª•ng nh·∫≠n d·∫°ng khu√¥n m·∫∑t th∆∞·ªùng ƒë∆∞·ª£c d√πng trong lƒ©nh v·ª±c n√†o?",
    answers: [
      { text: "An ninh", correct: true },
      { text: "Y t·∫ø", correct: false },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "Gi√°o d·ª•c", correct: false }
    ]
  },
  {
    q: "Nh·∫≠n d·∫°ng ch·ªØ vi·∫øt tay th∆∞·ªùng ƒë∆∞·ª£c ·ª©ng d·ª•ng trong vi·ªác g√¨?",
    answers: [
      { text: "X·ª≠ l√Ω h√≥a ƒë∆°n v√† t√†i li·ªáu", correct: true },
      { text: "D·ªãch thu·∫≠t ng√¥n ng·ªØ", correct: false },
      { text: "Nh·∫≠n di·ªán √¢m thanh", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false }
    ]
  },
  {
    q: "Tr·ª£ l√Ω ·∫£o nh∆∞ Siri ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ l√†m g√¨?",
    answers: [
      { text: "H·ªó tr·ª£ v√† t∆∞∆°ng t√°c v·ªõi ng∆∞·ªùi d√πng", correct: true },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "L√°i xe t·ª± ƒë·ªông", correct: false }
    ]
  },
  {
    q: "Netflix s·ª≠ d·ª•ng AI ƒë·ªÉ l√†m g√¨?",
    answers: [
      { text: "ƒê·ªÅ xu·∫•t phim d·ª±a tr√™n s·ªü th√≠ch ng∆∞·ªùi d√πng", correct: true },
      { text: "Nh·∫≠n di·ªán ch·ªØ vi·∫øt tay", correct: false },
      { text: "D·ªãch thu·∫≠t ng√¥n ng·ªØ", correct: false },
      { text: "H·ªó tr·ª£ y t·∫ø", correct: false }
    ]
  },
  {
    q: "MasterCard s·ª≠ d·ª•ng AI ƒë·ªÉ l√†m g√¨?",
    answers: [
      { text: "Ph√°t hi·ªán gian l·∫≠n trong giao d·ªãch", correct: true },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "ƒê·ªÅ xu·∫•t phim", correct: false },
      { text: "H·ªó tr·ª£ l√°i xe", correct: false }
    ]
  },
  {
    q: "Cambio Health Care s·ª≠ d·ª•ng AI ƒë·ªÉ l√†m g√¨?",
    answers: [
      { text: "H·ªó tr·ª£ quy·∫øt ƒë·ªãnh l√¢m s√†ng ph√≤ng ng·ª´a ƒë·ªôt qu·ªµ", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false }
    ]
  },
  {
    q: "H·ªá chuy√™n gia MYCIN s·ª≠ d·ª•ng bao nhi√™u lu·∫≠t suy di·ªÖn?",
    answers: [
      { text: "Kho·∫£ng 600", correct: true },
      { text: "Kho·∫£ng 100", correct: false },
      { text: "Kho·∫£ng 1000", correct: false },
      { text: "Kho·∫£ng 200", correct: false }
    ]
  },
  {
    q: "Robot Asimo c√≥ kh·∫£ nƒÉng n√†o sau ƒë√¢y?",
    answers: [
      { text: "Nh·∫≠n d·∫°ng ti·∫øng n√≥i", correct: true },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "Ph√°t hi·ªán gian l·∫≠n", correct: false }
    ]
  },
  {
    q: "Google Translate c√≥ th·ªÉ l√†m g√¨?",
    answers: [
      { text: "Nh·∫≠n d·∫°ng vƒÉn b·∫£n trong h√¨nh ·∫£nh", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "H·ªó tr·ª£ l√°i xe", correct: false }
    ]
  },
  {
    q: "AI c√≥ th·ªÉ ƒë∆∞·ª£c ·ª©ng d·ª•ng trong lƒ©nh v·ª±c n√†o sau ƒë√¢y?",
    answers: [
      { text: "T·∫•t c·∫£ c√°c lƒ©nh v·ª±c", correct: true },
      { text: "Ch·ªâ trong y t·∫ø", correct: false },
      { text: "Ch·ªâ trong gi√°o d·ª•c", correct: false },
      { text: "Ch·ªâ trong giao th√¥ng", correct: false }
    ]
  },
  {
    q: "H·ªá th·ªëng d·ª± b√°o th·ªùi ti·∫øt s·ª≠ d·ª•ng AI thu·ªôc kh·∫£ nƒÉng n√†o?",
    answers: [
      { text: "Gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "L√°i xe t·ª± ƒë·ªông", correct: false }
    ]
  },
  {
    q: "Xe t·ª± l√°i s·ª≠ d·ª•ng AI thu·ªôc kh·∫£ nƒÉng n√†o?",
    answers: [
      { text: "Nh·∫≠n th·ª©c", correct: true },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "Nh·∫≠n d·∫°ng ch·ªØ vi·∫øt tay", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false }
    ]
  },
  {
    q: "Tr·ª£ l√Ω ·∫£o nh∆∞ Alexa thu·ªôc kh·∫£ nƒÉng n√†o c·ªßa AI?",
    answers: [
      { text: "Hi·ªÉu ng√¥n ng·ªØ", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "L√°i xe t·ª± ƒë·ªông", correct: false }
    ]
  },
  {
    q: "H·ªá chuy√™n gia MYCIN ƒë∆∞·ª£c ph√°t tri·ªÉn t·∫°i ƒë√¢u?",
    answers: [
      { text: "ƒê·∫°i h·ªçc Stanford", correct: true },
      { text: "ƒê·∫°i h·ªçc Harvard", correct: false },
      { text: "ƒê·∫°i h·ªçc Cornell", correct: false },
      { text: "ƒê·∫°i h·ªçc New York", correct: false }
    ]
  },
  {
    q: "AI c√≥ th·ªÉ ƒë∆∞·ª£c chia th√†nh m·∫•y lo·∫°i ch√≠nh theo ch·ª©c nƒÉng?",
    answers: [
      { text: "2", correct: true },
      { text: "3", correct: false },
      { text: "4", correct: false },
      { text: "5", correct: false }
    ]
  },
  {
    q: "·ª®ng d·ª•ng n√†o sau ƒë√¢y thu·ªôc v·ªÅ AI h·∫πp?",
    answers: [
      { text: "Google Translate", correct: true },
      { text: "Robot c√≥ th·ªÉ l√†m m·ªçi vi·ªác nh∆∞ con ng∆∞·ªùi", correct: false },
      { text: "M√°y t√≠nh t·ª± h·ªçc m·ªçi lƒ©nh v·ª±c", correct: false },
      { text: "H·ªá th·ªëng thay th·∫ø con ng∆∞·ªùi ho√†n to√†n", correct: false }
    ]
  },
  {
    q: "Kh·∫£ nƒÉng n√†o kh√¥ng ph·∫£i l√† ƒë·∫∑c tr∆∞ng ch√≠nh c·ªßa AI?",
    answers: [
      { text: "C·∫£m th·ª• vƒÉn h·ªçc", correct: true },
      { text: "H·ªçc", correct: false },
      { text: "Suy lu·∫≠n", correct: false },
      { text: "Nh·∫≠n th·ª©c", correct: false }
    ]
  },
  {
    q: "Ph·∫ßn m·ªÅm ki·ªÉm tra l·ªói ch√≠nh t·∫£ thu·ªôc kh·∫£ nƒÉng n√†o c·ªßa AI?",
    answers: [
      { text: "Hi·ªÉu ng√¥n ng·ªØ", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "L√°i xe t·ª± ƒë·ªông", correct: false }
    ]
  },
  {
    q: "AI ƒë∆∞·ª£c ph√°t tri·ªÉn v·ªõi m·ª•c ti√™u g√¨?",
    answers: [
      { text: "X√¢y d·ª±ng h·ªá th·ªëng c√≥ ƒë·∫∑c tr∆∞ng tr√≠ tu·ªá nh∆∞ con ng∆∞·ªùi", correct: true },
      { text: "Thay th·∫ø ho√†n to√†n con ng∆∞·ªùi", correct: false },
      { text: "Ch·ªâ t·ª± ƒë·ªông h√≥a c√°c c√¥ng vi·ªác ƒë∆°n gi·∫£n", correct: false },
      { text: "Kh√¥ng c·∫ßn s·ª≠ d·ª•ng d·ªØ li·ªáu", correct: false }
    ]
  },
  {
    q: "H·ªá th·ªëng khuy·∫øn ngh·ªã c·ªßa YouTube thu·ªôc kh·∫£ nƒÉng n√†o c·ªßa AI?",
    answers: [
      { text: "H·ªçc", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "L√°i xe t·ª± ƒë·ªông", correct: false }
    ]
  },
  {
    q: "H·ªá th·ªëng ch·∫©n ƒëo√°n y t·∫ø d·ª±a tr√™n AI thu·ªôc kh·∫£ nƒÉng n√†o?",
    answers: [
      { text: "Suy lu·∫≠n", correct: true },
      { text: "Nh·∫≠n d·∫°ng ch·ªØ vi·∫øt tay", correct: false },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false }
    ]
  },
  {
    q: "·ª®ng d·ª•ng n√†o sau ƒë√¢y s·ª≠ d·ª•ng kh·∫£ nƒÉng nh·∫≠n th·ª©c c·ªßa AI?",
    answers: [
      { text: "Xe t·ª± l√°i", correct: true },
      { text: "Gu·ªìng n∆∞·ªõc", correct: false },
      { text: "M√°y gi·∫∑t t·ª± ƒë·ªông", correct: false },
      { text: "ƒê√®n t·ª± s√°ng khi tr·ªùi t·ªëi", correct: false }
    ]
  },
  {
    q: "AI c√≥ th·ªÉ ƒë∆∞·ª£c ·ª©ng d·ª•ng trong lƒ©nh v·ª±c n√†o sau ƒë√¢y?",
    answers: [
      { text: "Khoa h·ªçc v√† ƒë·ªùi s·ªëng", correct: true },
      { text: "Ch·ªâ trong c√¥ng ngh·ªá", correct: false },
      { text: "Ch·ªâ trong y t·∫ø", correct: false },
      { text: "Ch·ªâ trong gi√°o d·ª•c", correct: false }
    ]
  },
  {
    q: "Robot Asimo c√≥ kh·∫£ nƒÉng n√†o sau ƒë√¢y?",
    answers: [
      { text: "Nh·∫≠n d·∫°ng h√¨nh ·∫£nh", correct: true },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "Ph√°t hi·ªán gian l·∫≠n", correct: false }
    ]
  },
  {
    q: "Google Translate c√≥ th·ªÉ t·ª± ƒë·ªông l√†m g√¨?",
    answers: [
      { text: "Ph√°t hi·ªán ng√¥n ng·ªØ", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "H·ªó tr·ª£ l√°i xe", correct: false }
    ]
  },
  {
    q: "·ª®ng d·ª•ng nh·∫≠n d·∫°ng khu√¥n m·∫∑t c√≥ th·ªÉ ƒë∆∞·ª£c d√πng ƒë·ªÉ l√†m g√¨?",
    answers: [
      { text: "M·ªü kh√≥a ƒëi·ªán tho·∫°i", correct: true },
      { text: "D·ªãch thu·∫≠t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "Nh·∫≠n d·∫°ng ch·ªØ vi·∫øt tay", correct: false }
    ]
  },
  {
    q: "Tr·ª£ l√Ω ·∫£o nh∆∞ Cortana c√≥ th·ªÉ l√†m g√¨?",
    answers: [
      { text: "G·ªçi ƒëi·ªán tho·∫°i theo t√™n trong danh b·∫°", correct: true },
      { text: "Nh·∫≠n d·∫°ng khu√¥n m·∫∑t", correct: false },
      { text: "D·ª± b√°o th·ªùi ti·∫øt", correct: false },
      { text: "L√°i xe t·ª± ƒë·ªông", correct: false }
    ]
  }
];

  // Tr·∫Øc nghi·ªám ƒë√∫ng/sai [DS]
¬† const trueFalseQuestions = [
  {
    q: "Tr√≠ tu·ªá nh√¢n t·∫°o (AI) l√† kh·∫£ nƒÉng c·ªßa m√°y t√≠nh th·ª±c hi·ªán c√°c c√¥ng vi·ªác mang t√≠nh tr√≠ tu·ªá c·ªßa con ng∆∞·ªùi nh∆∞ ƒë·ªçc ch·ªØ, hi·ªÉu ti·∫øng n√≥i, d·ªãch thu·∫≠t, l√°i xe hay h·ªçc v√† ra quy·∫øt ƒë·ªãnh. AI c√≥ c√°c ƒë·∫∑c tr∆∞ng ch√≠nh nh∆∞ kh·∫£ nƒÉng h·ªçc, suy lu·∫≠n, nh·∫≠n th·ª©c, hi·ªÉu ng√¥n ng·ªØ v√† gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ.",
    answers: [
      { text: "AI c√≥ kh·∫£ nƒÉng h·ªçc t·ª´ d·ªØ li·ªáu", correct: true },
      { text: "AI kh√¥ng th·ªÉ hi·ªÉu ng√¥n ng·ªØ t·ª± nhi√™n", correct: false },
      { text: "AI ch·ªâ c√≥ th·ªÉ th·ª±c hi·ªán c√°c c√¥ng vi·ªác ƒë∆°n gi·∫£n", correct: false },
      { text: "AI c√≥ kh·∫£ nƒÉng nh·∫≠n th·ª©c m√¥i tr∆∞·ªùng xung quanh", correct: true }
    ]
  },
  {
    q: "H·ªá chuy√™n gia MYCIN l√† m·ªôt h·ªá th·ªëng AI trong lƒ©nh v·ª±c y h·ªçc, ƒë∆∞·ª£c ph√°t tri·ªÉn ƒë·ªÉ ch·∫©n ƒëo√°n b·ªánh v√† ƒë·ªÅ xu·∫•t s·ª≠ d·ª•ng kh√°ng sinh. MYCIN s·ª≠ d·ª•ng kho·∫£ng 600 lu·∫≠t suy di·ªÖn ƒë·ªÉ ƒë∆∞a ra k·∫øt lu·∫≠n d·ª±a tr√™n tri·ªáu ch·ª©ng.",
    answers: [
      { text: "MYCIN l√† m·ªôt ·ª©ng d·ª•ng c·ªßa AI trong y h·ªçc", correct: true },
      { text: "MYCIN kh√¥ng th·ªÉ suy lu·∫≠n", correct: false },
      { text: "MYCIN s·ª≠ d·ª•ng h∆°n 1000 lu·∫≠t suy di·ªÖn", correct: false },
      { text: "MYCIN c√≥ th·ªÉ ƒë·ªÅ xu·∫•t li·ªÅu l∆∞·ª£ng kh√°ng sinh", correct: true }
    ]
  },
  {
    q: "Robot Asimo l√† robot h√¨nh ng∆∞·ªùi ƒë·∫ßu ti√™n tr√™n th·∫ø gi·ªõi, t√≠ch h·ª£p nhi·ªÅu ·ª©ng d·ª•ng AI nh∆∞ t·ª± ƒë·ªông ƒëi·ªÅu khi·ªÉn, nh·∫≠n d·∫°ng h√¨nh ·∫£nh v√† ti·∫øng n√≥i. Asimo c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi con ng∆∞·ªùi nh·ªù c√°c kh·∫£ nƒÉng h·ªçc, nh·∫≠n th·ª©c v√† hi·ªÉu ng√¥n ng·ªØ.",
    answers: [
      { text: "Asimo l√† robot h√¨nh ng∆∞·ªùi", correct: true },
      { text: "Asimo kh√¥ng th·ªÉ nh·∫≠n d·∫°ng ti·∫øng n√≥i", correct: false },
      { text: "Asimo c√≥ kh·∫£ nƒÉng h·ªçc", correct: true },
      { text: "Asimo ch·ªâ th·ª±c hi·ªán m·ªôt nhi·ªám v·ª• duy nh·∫•t", correct: false }
    ]
  },
  {
    q: "Google Translate l√† m·ªôt ·ª©ng d·ª•ng d·ªãch thu·∫≠t s·ª≠ d·ª•ng AI ƒë·ªÉ nh·∫≠n d·∫°ng vƒÉn b·∫£n, t·ª± ƒë·ªông ph√°t hi·ªán ng√¥n ng·ªØ v√† d·ªãch tr·ª±c ti·∫øp. N√≥ c√≥ kh·∫£ nƒÉng h·ªçc, suy lu·∫≠n v√† nh·∫≠n th·ª©c ƒë·ªÉ c·∫£i thi·ªán ƒë·ªô ch√≠nh x√°c c·ªßa b·∫£n d·ªãch.",
    answers: [
      { text: "Google Translate c√≥ th·ªÉ nh·∫≠n d·∫°ng vƒÉn b·∫£n trong h√¨nh ·∫£nh", correct: true },
      { text: "Google Translate kh√¥ng s·ª≠ d·ª•ng AI", correct: false },
      { text: "Google Translate c√≥ kh·∫£ nƒÉng h·ªçc t·ª´ d·ªØ li·ªáu", correct: true },
      { text: "Google Translate ch·ªâ d·ªãch ƒë∆∞·ª£c m·ªôt ng√¥n ng·ªØ", correct: false }
    ]
  },
  {
    q: "Tr·ª£ l√Ω ·∫£o nh∆∞ Siri, Cortana v√† Alexa l√† c√°c ·ª©ng d·ª•ng AI h·ªó tr·ª£ ng∆∞·ªùi d√πng qua vi·ªác tr√≤ chuy·ªán, t√¨m ki·∫øm th√¥ng tin, g·ªçi ƒëi·ªán tho·∫°i v√† nhi·ªÅu t√≠nh nƒÉng kh√°c. Ch√∫ng s·ª≠ d·ª•ng AI ƒë·ªÉ hi·ªÉu ng√¥n ng·ªØ t·ª± nhi√™n v√† ph·∫£n h·ªìi ph√π h·ª£p.",
    answers: [
      { text: "Tr·ª£ l√Ω ·∫£o c√≥ th·ªÉ tr√≤ chuy·ªán v·ªõi ng∆∞·ªùi d√πng", correct: true },
      { text: "Tr·ª£ l√Ω ·∫£o kh√¥ng th·ªÉ hi·ªÉu ti·∫øng n√≥i", correct: false },
      { text: "Tr·ª£ l√Ω ·∫£o c√≥ th·ªÉ t√¨m ki·∫øm th√¥ng tin", correct: true },
      { text: "Tr·ª£ l√Ω ·∫£o ch·ªâ ho·∫°t ƒë·ªông tr√™n m√°y t√≠nh", correct: false }
    ]
  }
];

  // T·ª± lu·∫≠n [TL]
  const essayQuestions = [
  {
    q: "Tr√≠ tu·ªá nh√¢n t·∫°o (AI) l√† g√¨? H√£y n√™u c√°c ƒë·∫∑c tr∆∞ng ch√≠nh c·ªßa AI.",
    answerRef: "Tr√≠ tu·ªá nh√¢n t·∫°o (AI) l√† kh·∫£ nƒÉng c·ªßa m√°y t√≠nh th·ª±c hi·ªán c√°c c√¥ng vi·ªác mang t√≠nh tr√≠ tu·ªá c·ªßa con ng∆∞·ªùi nh∆∞ ƒë·ªçc ch·ªØ, hi·ªÉu ti·∫øng n√≥i, d·ªãch thu·∫≠t, l√°i xe, h·ªçc v√† ra quy·∫øt ƒë·ªãnh. C√°c ƒë·∫∑c tr∆∞ng ch√≠nh c·ªßa AI bao g·ªìm: kh·∫£ nƒÉng h·ªçc, kh·∫£ nƒÉng suy lu·∫≠n, kh·∫£ nƒÉng nh·∫≠n th·ª©c, kh·∫£ nƒÉng hi·ªÉu ng√¥n ng·ªØ v√† kh·∫£ nƒÉng gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ."
  },
  {
    q: "Ph√¢n bi·ªát gi·ªØa AI h·∫πp v√† AI t·ªïng qu√°t.",
    answerRef: "AI h·∫πp (Narrow AI) l√† AI ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ th·ª±c hi·ªán m·ªôt nhi·ªám v·ª• c·ª• th·ªÉ nh∆∞ nh·∫≠n d·∫°ng khu√¥n m·∫∑t ho·∫∑c d·ªãch thu·∫≠t. AI t·ªïng qu√°t (General AI) l√† AI c√≥ kh·∫£ nƒÉng t·ª± h·ªçc, t·ª± th√≠ch nghi v√† th·ª±c hi·ªán nhi·ªÅu c√¥ng vi·ªác gi·ªëng con ng∆∞·ªùi, v√≠ d·ª• nh∆∞ m·ªôt robot ƒëa nƒÉng."
  },
  {
    q: "H√£y n√™u m·ªôt s·ªë ·ª©ng d·ª•ng th·ª±c t·∫ø c·ªßa AI m√† b·∫°n bi·∫øt.",
    answerRef: "M·ªôt s·ªë ·ª©ng d·ª•ng th·ª±c t·∫ø c·ªßa AI bao g·ªìm: h·ªá chuy√™n gia MYCIN (ch·∫©n ƒëo√°n y h·ªçc), robot Asimo (t∆∞∆°ng t√°c v·ªõi con ng∆∞·ªùi), Google Translate (d·ªãch thu·∫≠t), nh·∫≠n d·∫°ng khu√¥n m·∫∑t (an ninh), nh·∫≠n d·∫°ng ch·ªØ vi·∫øt tay (x·ª≠ l√Ω t√†i li·ªáu), tr·ª£ l√Ω ·∫£o nh∆∞ Siri, h·ªá th·ªëng ƒë·ªÅ xu·∫•t phim c·ªßa Netflix, v√† h·ªá th·ªëng ph√°t hi·ªán gian l·∫≠n c·ªßa MasterCard."
  },
  {
    q: "T·∫°i sao AI l·∫°i quan tr·ªçng trong x√£ h·ªôi ng√†y nay?",
    answerRef: "AI quan tr·ªçng v√¨ n√≥ gi√∫p t·ª± ƒë·ªông h√≥a c√¥ng vi·ªác, n√¢ng cao hi·ªáu su·∫•t, h·ªó tr·ª£ ra quy·∫øt ƒë·ªãnh v√† gi·∫£i quy·∫øt c√°c v·∫•n ƒë·ªÅ ph·ª©c t·∫°p trong nhi·ªÅu lƒ©nh v·ª±c nh∆∞ y t·∫ø, gi√°o d·ª•c, t√†i ch√≠nh, an ninh. AI c√≥ ti·ªÅm nƒÉng c·∫£i thi·ªán ch·∫•t l∆∞·ª£ng cu·ªôc s·ªëng v√† thay ƒë·ªïi c√°ch ch√∫ng ta l√†m vi·ªác."
  },
  {
    q: "B·∫°n nghƒ© AI c√≥ th·ªÉ thay th·∫ø ho√†n to√†n con ng∆∞·ªùi trong t∆∞∆°ng lai kh√¥ng? Gi·∫£i th√≠ch l√Ω do.",
    answerRef: "AI c√≥ th·ªÉ thay th·∫ø con ng∆∞·ªùi trong m·ªôt s·ªë c√¥ng vi·ªác l·∫∑p l·∫°i ho·∫∑c x·ª≠ l√Ω d·ªØ li·ªáu l·ªõn, nh∆∞ng kh√≥ thay th·∫ø ho√†n to√†n v√¨ n√≥ thi·∫øu kh·∫£ nƒÉng c·∫£m x√∫c, s√°ng t·∫°o v√† x·ª≠ l√Ω c√°c t√¨nh hu·ªëng ph·ª©c t·∫°p nh∆∞ con ng∆∞·ªùi. AI c√≥ th·ªÉ h·ªó tr·ª£ con ng∆∞·ªùi hi·ªáu qu·∫£ h∆°n l√† thay th·∫ø ho√†n to√†n."
  }
];

  // --- UTILITY FUNCTIONS ---
  function shuffleArray(arr) {
    for(let i = arr.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function escapeHtml(unsafe) {
    return unsafe
      .replace(/</g, "‚Äπ")
      .replace(/>/g, "‚Ä∫")
      .replace(/"/g, "'");
  }

  // --- DOM ELEMENTS ---
  const btnMulti = document.getElementById('btn-multi');
  const btnTrueFalse = document.getElementById('btn-truefalse');
  const btnEssay = document.getElementById('btn-essay');
  const toggleThemeBtn = document.getElementById('toggle-theme');
  const btnExit = document.getElementById('btn-exit'); 
  const btnBackHomeInQuiz = document.getElementById('btn-back-home-in-quiz'); // N√∫t Back Home trong quiz
  const btnDownload = document.getElementById('btn-download');

  const quizSection = document.getElementById('quiz-section');
  const questionBlock = document.getElementById('question-block');
  const answersBlock = document.getElementById('answers-block');
  const essayInputBlock = document.getElementById('essay-input-block');
  const essayAnswerTextarea = document.getElementById('essay-answer');
  const btnEssaySubmit = document.getElementById('btn-essay-submit');
  const btnNext = document.getElementById('btn-next');

  const timerSpan = document.getElementById('timer');
  const doneCountSpan = document.getElementById('done-count');
  const correctCountSpan = document.getElementById('correct-count');
  const wrongCountSpan = document.getElementById('wrong-count');

  const resultSection = document.getElementById('result-section');
  const resultTime = document.getElementById('result-time');
  const resultTotal = document.getElementById('result-total');
  const resultCorrect = document.getElementById('result-correct');
  const resultWrong = document.getElementById('result-wrong');
  const starRating = document.getElementById('star-rating');

  // const btnRestart = document.getElementById('btn-restart'); // ƒê√£ x√≥a kh·ªèi HTML, n√™n b·ªè d√≤ng n√†y ho·∫∑c comment l·∫°i
  const btnHome = document.getElementById('btn-home');

  // --- STATE VARIABLES ---
  let quizType = null; // 'multi', 'truefalse', 'essay'
  let questions = [];
  let currentQIdx = 0;
  let timerInterval = null;
  let timeSeconds = 0;
  let doneCount = 0;
  let correctCount = 0;
  let wrongCount = 0;
  let currentTFAnswerIdx = 0;

  // --- TIMER FUNCTIONS ---
  function startTimer() {
    timeSeconds = 0;
    timerSpan.textContent = formatTime(timeSeconds);
    if(timerInterval) clearInterval(timerInterval);
    timerInterval = setInterval(() => {
      timeSeconds++;
      timerSpan.textContent = formatTime(timeSeconds);
    }, 1000);
  }

  function stopTimer() {
    if(timerInterval) clearInterval(timerInterval);
  }

  function formatTime(s) {
    const m = Math.floor(s/60);
    const sec = s % 60;
    return (m < 10 ? '0' + m : m) + ':' + (sec < 10 ? '0' + sec : sec);
  }

  // --- QUIZ FUNCTIONS ---
  function resetStats() {
    doneCount = 0;
    correctCount = 0;
    wrongCount = 0;
    doneCountSpan.textContent = "0";
    correctCountSpan.textContent = "0";
    wrongCountSpan.textContent = "0";
  }

  function initQuiz(type) {
    quizType = type;
    currentQIdx = 0;
    resetStats();

    if(type === 'multi') {
      questions = multiChoiceQuestions.map(q => ({
        q: q.q,
        qImage: q.qImage,
        answers: shuffleArray(q.answers.slice())
      }));
      shuffleArray(questions);
    } else if(type === 'truefalse') {
      questions = trueFalseQuestions.map(q => ({
        q: q.q,
        qImage: q.qImage,
        answers: shuffleArray(q.answers.slice())
      }));
      shuffleArray(questions);
      currentTFAnswerIdx = 0;
    } else if(type === 'essay') {
      questions = essayQuestions.map(q => ({
        q: q.q,
        qImage: q.qImage,
        answerRef: q.answerRef,
        answerRefImage: q.answerRefImage
      }));
      shuffleArray(questions);
    }
    
    quizSection.style.display = 'block';
    resultSection.style.display = 'none';
    btnMulti.style.display = 'none';
    btnTrueFalse.style.display = 'none';
    btnEssay.style.display = 'none';
    btnExit.style.display = 'none'; // ·∫®n n√∫t Exit khi b·∫Øt ƒë·∫ßu quiz
    toggleThemeBtn.style.display = 'none'; // ·∫®n n√∫t chuy·ªÉn theme khi v√†o quiz
    btnDownload.style.display = 'none';

    showQuestion();
    startTimer();
  }

  function showQuestion() {
    // ·∫®n n√∫t "Ti·∫øp t·ª•c" n·∫øu n√≥ ƒëang hi·ªÉn th·ªã
    btnNext.style.display = 'none'; 
    // N·∫øu l√† d·∫°ng t·ª± lu·∫≠n, n√∫t "Xong" (submit) s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã, ng∆∞·ª£c l·∫°i ·∫©n
    btnEssaySubmit.style.display = (quizType === 'essay') ? 'block' : 'none';
    // ƒê·∫£m b·∫£o n√∫t "Xong" ƒë∆∞·ª£c k√≠ch ho·∫°t l·∫°i cho c√¢u h·ªèi t·ª± lu·∫≠n m·ªõi
    btnEssaySubmit.disabled = false; 

    answersBlock.innerHTML = ''; // X√≥a c√°c c√¢u tr·∫£ l·ªùi c≈©
    essayInputBlock.style.display = 'none'; // ·∫®n khung nh·∫≠p t·ª± lu·∫≠n
    essayAnswerTextarea.value = ''; // X√≥a n·ªôi dung c≈© trong khung t·ª± lu·∫≠n
    
    if (currentQIdx >= questions.length) {
      endQuiz();
      return;
    }

    const currentQ = questions[currentQIdx];
    
    // Display question text and image (if any)
    let questionHTML = `
      <div style="color: var(--orange); font-weight: bold; margin-bottom: 15px;">
        C√¢u ${currentQIdx + 1}: ${escapeHtml(currentQ.q)}
      </div>
    `;
    
    if (currentQ.qImage) {
      questionHTML += `
        <div style="text-align: center; margin: 15px 0;">
          <img src="${currentQ.qImage}" 
               style="max-width: 100%; max-height: 300px; border: 1px solid #ccc; border-radius: 5px;"
               onerror="this.style.display='none'">
        </div>
      `;
    }
    
    questionBlock.innerHTML = questionHTML;

    if (quizType === 'multi') {
      // Multiple choice questions
      answersBlock.style.display = 'block';
      currentQ.answers.forEach((ans, i) => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        
        let answerContent = `${String.fromCharCode(65 + i)}. ${escapeHtml(ans.text)}`;
        
        if (ans.image) {
          answerContent += `
            <div style="margin-top: 8px; text-align: center;">
              <img src="${ans.image}" 
                   style="max-width: 100%; max-height: 150px; border: 1px solid #ddd; border-radius: 3px;"
                   onerror="this.style.display='none'">
            </div>
          `;
        }
        
        btn.innerHTML = answerContent;
        btn.onclick = () => handleMultiAnswerClick(btn, ans.correct, currentQ.answers);
        answersBlock.appendChild(btn);
      });

    } else if (quizType === 'truefalse') {
      // True/False questions
      answersBlock.style.display = 'block';
      currentTFAnswerIdx = 0;
      showTrueFalseAnswer(currentQ.answers[currentTFAnswerIdx]);
      
    } else if (quizType === 'essay') {
      // Essay questions
      essayInputBlock.style.display = 'block';
    }
  }

  function handleMultiAnswerClick(btn, isCorrect, allAnswers) {
    Array.from(answersBlock.children).forEach(b => b.classList.add('disabled'));

    doneCount++;
    doneCountSpan.textContent = doneCount;

    if(isCorrect) {
      btn.classList.add('correct');
      correctCount++;
      correctCountSpan.textContent = correctCount;
    } else {
      btn.classList.add('incorrect');
      wrongCount++;
      wrongCountSpan.textContent = wrongCount;
      // Highlight correct answer
      const correctAns = allAnswers.find(a => a.correct);
      for(let b of answersBlock.children) {
        // C·∫©n th·∫≠n v·ªõi vi·ªác so s√°nh textContent tr·ª±c ti·∫øp n·∫øu c√≥ h√¨nh ·∫£nh
        // C·∫ßn l·∫•y ch·ªâ ph·∫ßn text c·ªßa c√¢u tr·∫£ l·ªùi
        const btnText = b.childNodes[0].nodeType === 3 ? b.childNodes[0].nodeValue.substring(3).trim() : ''; // L·∫•y text tr∆∞·ªõc h√¨nh ·∫£nh
        const correctText = escapeHtml(correctAns.text);

        if(btnText === correctText && correctAns.correct) {
          b.classList.add('correct');
          break;
        }
      }
    }
    btnNext.style.display = 'inline-block';
  }

  function showTrueFalseAnswer(answerObj) {
    answersBlock.innerHTML = '';

    const label = document.createElement('div');
    label.style.marginBottom = '10px';
    label.style.fontWeight = 'bold';
    label.textContent = `C√¢u h·ªèi ph·ª• ${currentTFAnswerIdx + 1}: ${answerObj.text}`;
    answersBlock.appendChild(label);

    if (answerObj.image) {
      const imgDiv = document.createElement('div');
      imgDiv.style.textAlign = 'center';
      imgDiv.style.margin = '10px 0';
      imgDiv.innerHTML = `<img src="${answerObj.image}" style="max-width: 100%; max-height: 200px; border: 1px solid #ccc; border-radius: 3px;" onerror="this.style.display='none'">`;
      answersBlock.appendChild(imgDiv);
    }

    const btnTrue = document.createElement('button');
    btnTrue.className = 'answer-btn';
    btnTrue.textContent = 'ƒê√∫ng';
    btnTrue.onclick = () => handleTrueFalseAnswerClick(true, answerObj.correct);
    answersBlock.appendChild(btnTrue);
    
    const btnFalse = document.createElement('button');
    btnFalse.className = 'answer-btn';
    btnFalse.textContent = 'Sai';
    btnFalse.onclick = () => handleTrueFalseAnswerClick(false, answerObj.correct);
    answersBlock.appendChild(btnFalse);
  }

  function handleTrueFalseAnswerClick(userAnswer, correctAnswer) {
    Array.from(answersBlock.querySelectorAll('button')).forEach(b => b.classList.add('disabled'));

    doneCount++;
    doneCountSpan.textContent = doneCount;

    if(userAnswer === correctAnswer) {
      correctCount++;
      correctCountSpan.textContent = correctCount;
      Array.from(answersBlock.querySelectorAll('button')).forEach(b => {
        if(b.textContent.toLowerCase() === (userAnswer ? 'ƒë√∫ng' : 'sai')) {
          b.classList.add('correct');
        }
      });
    } else {
      wrongCount++;
      wrongCountSpan.textContent = wrongCount;
      Array.from(answersBlock.querySelectorAll('button')).forEach(b => {
        if(b.textContent.toLowerCase() === (userAnswer ? 'ƒë√∫ng' : 'sai')) {
          b.classList.add('incorrect');
        }
        if(b.textContent.toLowerCase() === (correctAnswer ? 'ƒë√∫ng' : 'sai')) {
          b.classList.add('correct');
        }
      });
    }

    btnNext.style.display = 'inline-block';
  }

  // Essay submit handler
  btnEssaySubmit.onclick = () => {
    const userText = essayAnswerTextarea.value.trim();
    if(userText.length === 0) {
      alert('H√£y nh·∫≠p c√¢u tr·∫£ l·ªùi tr∆∞·ªõc khi nh·∫•n "Xong"');
      return;
    }
    btnEssaySubmit.disabled = true; // V√¥ hi·ªáu h√≥a n√∫t "Xong" sau khi submit
    
    doneCount++;
    doneCountSpan.textContent = doneCount;

    const currentQ = questions[currentQIdx];
    let answerRefHTML = `<br><br><em><strong>ƒê√°p √°n tham kh·∫£o:</strong> ${currentQ.answerRef}</em>`;
    
    if(currentQ.answerRefImage) {
      answerRefHTML += `<div style="margin: 15px 0; text-align: center;">
        <img src="${currentQ.answerRefImage}" style="max-width: 100%; max-height: 300px; border: 1px solid #ccc; border-radius: 5px;">
      </div>`;
    }
    
    questionBlock.innerHTML += answerRefHTML;
    btnNext.style.display = 'inline-block';
  };

  btnNext.onclick = () => {
    // ·∫®n n√∫t "Ti·∫øp t·ª•c"
    btnNext.style.display = 'none';
    // ƒê·∫£m b·∫£o n√∫t "Xong" (essay) ƒë∆∞·ª£c k√≠ch ho·∫°t l·∫°i
    btnEssaySubmit.disabled = false; 

    if(quizType === 'truefalse') {
      currentTFAnswerIdx++;
      const currentQ = questions[currentQIdx];
      // N·∫øu c√≤n c√¢u h·ªèi ph·ª• trong c√¢u h·ªèi ƒê√∫ng/Sai hi·ªán t·∫°i
      if(currentTFAnswerIdx < currentQ.answers.length) {
        showTrueFalseAnswer(currentQ.answers[currentTFAnswerIdx]);
        return; // Kh√¥ng chuy·ªÉn sang c√¢u h·ªèi ti·∫øp theo m√† hi·ªÉn th·ªã c√¢u ph·ª•
      }
    }

    // Chuy·ªÉn sang c√¢u h·ªèi ti·∫øp theo
    currentQIdx++;
    showQuestion();
  };

  function endQuiz() {
    stopTimer();
    quizSection.style.display = 'none';
    resultSection.style.display = 'block';
    toggleThemeBtn.style.display = 'block'; // Hi·ªÉn th·ªã l·∫°i n√∫t chuy·ªÉn theme

    resultTime.textContent = formatTime(timeSeconds);
    resultTotal.textContent = doneCount;
    resultCorrect.textContent = correctCount;
    resultWrong.textContent = wrongCount;

    starRating.innerHTML = '';

    // Logic t√≠nh sao ƒë√£ ƒë∆∞·ª£c kh√¥i ph·ª•c v√† tinh ch·ªânh
    if(quizType === 'multi' || quizType === 'truefalse') {
      let starsGreen = 0;
      let starsGray = 0;
      
      if(wrongCount === 0) { // N·∫øu kh√¥ng c√≥ c√¢u sai
        starsGreen = 3; // 3 sao xanh
      } else if (wrongCount >= 1 && wrongCount <= 3) {
        starsGreen = 2; // 2 sao xanh
        starsGray = 1; // 1 sao x√°m
      } else if (wrongCount >= 4 && wrongCount <= 9) {
        starsGreen = 1; // 1 sao xanh
        starsGray = 2; // 2 sao x√°m
      } else { // wrongCount >= 10
        starsGreen = 0; // 0 sao xanh
        starsGray = 3; // 3 sao x√°m
      }

      for(let i = 1; i <= 3; i++) {
        const star = document.createElement('span');
        star.classList.add('star');
        if(i <= starsGreen) star.classList.add('Green');
        else if(i <= starsGray) star.classList.add('gray');
        star.innerHTML = '&#9733;';
        starRating.appendChild(star);
      }
    } else if (quizType === 'essay') {
        // ƒê·ªëi v·ªõi b√†i t·ª± lu·∫≠n, kh√¥ng c√≥ ƒëi·ªÉm ƒë√∫ng/sai t·ª± ƒë·ªông
        // B·∫°n c√≥ th·ªÉ th√™m logic ch·∫•m ƒëi·ªÉm th·ªß c√¥ng ho·∫∑c hi·ªÉn th·ªã th√¥ng b√°o kh√°c
        const infoDiv = document.createElement('div');
        infoDiv.textContent = "B√†i T·ª± Lu·∫≠n C·∫ßn ƒê∆∞·ª£c Gi√°o Vi√™n Ch·∫•m ƒêi·ªÉm.";
        infoDiv.style.fontWeight = "bold";
        infoDiv.style.marginTop = "20px";
        starRating.appendChild(infoDiv);
    }
  }

  // --- EVENT LISTENERS ---
  // ƒê√£ x√≥a btnRestart.onclick v√† logic li√™n quan
  // N·∫øu b·∫°n mu·ªën ch·ª©c nƒÉng "l√†m l·∫°i" b√†i quiz, b·∫°n c·∫ßn t·∫°o m·ªôt n√∫t m·ªõi v·ªõi ID kh√°c
  // v√† th√™m l·∫°i logic reset Stats v√†o event listener c·ªßa n√∫t ƒë√≥.

  // N√∫t Home (·ªü m√†n h√¨nh k·∫øt qu·∫£) - v·∫´n reload trang hi·ªán t·∫°i
  btnHome.onclick = () => {
    location.reload(); 
  };

  btnMulti.onclick = () => initQuiz('multi');
  btnTrueFalse.onclick = () => initQuiz('truefalse');
  btnEssay.onclick = () => initQuiz('essay');
  // New: Download button functionality
  btnDownload.onclick = () => {
    const htmlContent = document.documentElement.outerHTML;
    const blob = new Blob([htmlContent], { type: 'text/html' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'toancreator-default'; // Set the desired filename
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
  };
  
  
  // X·ª≠ l√Ω s·ª± ki·ªán cho n√∫t Exit m·ªõi
  btnExit.onclick = () => {
    window.location.href = '../index.html'; // Chuy·ªÉn h∆∞·ªõng v·ªÅ index.html
  };

  // X·ª≠ l√Ω s·ª± ki·ªán cho n√∫t Back to Home trong quiz
  btnBackHomeInQuiz.onclick = () => {
    if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën tho√°t b√†i l√†m hi·ªán t·∫°i?')) {
      stopTimer(); // D·ª´ng ƒë·ªìng h·ªì
      location.reload(); // T·∫£i l·∫°i trang promt-onlineV2.html
    }
  };

  toggleThemeBtn.onclick = () => {
    document.body.classList.toggle('dark');
  };

  // ·∫®n/hi·ªán n√∫t toggle theme ban ƒë·∫ßu
  // B·∫°n c√≥ th·ªÉ ƒë·∫∑t n√∫t toggle theme ·ªü v·ªã tr√≠ c·ªë ƒë·ªãnh thay v√¨ ·∫©n/hi·ªán t√πy thu·ªôc v√†o m√†n h√¨nh
  // Hi·ªán t·∫°i, n√≥ s·∫Ω lu√¥n hi·ªÉn th·ªã tr·ª´ khi b·ªã ·∫©n b·ªüi CSS ho·∫∑c logic kh√°c
  toggleThemeBtn.style.display = 'block'; 
})();
</script>
</body>
</html>